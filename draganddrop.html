<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Excel Drag & Drop Modern</title>
    <!-- Memuat Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Menggunakan font Inter */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
        }

        /* Gradient Biru Langit (Sky Blue Gradient) */
        .gradient-background {
            background: linear-gradient(135deg, #89cff0 0%, #4682b4 100%); /* Light Sky Blue to Steel Blue */
        }

        /* Dropzone Styling */
        .dropzone {
            min-height: 7rem;
            border: 3px dashed #ffffff;
            background-color: rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease-in-out;
        }
        .dropzone.drag-over {
            background-color: rgba(255, 255, 255, 0.3);
            border-color: #ffffff;
            border-style: solid;
        }

        /* Piece Styling */
        .piece {
            transition: all 0.15s ease-in-out;
            cursor: grab;
        }
        .piece:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .piece:active {
            cursor: grabbing;
        }
        
        /* Message Box */
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 50;
        }
    </style>
</head>
<body class="gradient-background flex items-center justify-center p-4">

    <!-- Modal/Message Box (Hidden by default) -->
    <div id="messageModal" class="hidden message-box w-11/12 max-w-sm bg-white p-6 rounded-xl shadow-2xl transition duration-300 transform scale-95">
        <h3 id="modalTitle" class="text-2xl font-bold mb-3 text-gray-800"></h3>
        <p id="modalMessage" class="text-gray-600 mb-6"></p>
        <button onclick="closeModal()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 rounded-lg transition duration-150 shadow-md">OK</button>
    </div>

    <!-- Konten Kuis Utama -->
    <div class="w-full max-w-4xl bg-white p-8 md:p-12 rounded-2xl shadow-2xl">
        
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-extrabold text-gray-800">Kuis Formula Excel</h1>
            <a href="index.html" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-medium py-2 px-4 rounded-full transition duration-200 shadow-md flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                </svg>
                Kembali ke Beranda
            </a>
        </div>
        
        <p class="text-lg mb-2 text-gray-600">Soal <span id="questionNumber">1</span> dari <span id="totalQuestions">100</span></p>
        <h2 id="questionText" class="text-2xl font-semibold mb-6 text-gray-700"></h2>

        <!-- Dropzone Jawaban -->
        <div id="answer" class="dropzone mb-6 rounded-lg flex flex-wrap items-center gap-2 p-4 text-xl font-mono text-white shadow-inner bg-opacity-80 transition-colors duration-200">
            <span class="text-gray-400 text-base italic">Tarik potongan formula ke sini...</span>
        </div>

        <!-- Potongan Formula (Pieces) -->
        <div id="pieces" class="flex flex-wrap gap-3 mb-8 justify-center">
            <!-- Pieces will be generated by JavaScript -->
        </div>

        <!-- Tombol Aksi -->
        <div class="flex gap-4 justify-center">
            <button onclick="checkAnswer()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition duration-200 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-blue-300">
                Cek Jawaban
            </button>
            <button onclick="resetQuestion()" class="bg-red-400 hover:bg-red-500 text-white font-semibold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition duration-200 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-red-300">
                Ulangi
            </button>
            <button onclick="nextQuestion()" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg hover:shadow-xl transition duration-200 transform hover:scale-[1.01] focus:outline-none focus:ring-4 focus:ring-green-300" disabled id="nextButton">
                Soal Selanjutnya
            </button>
        </div>

    </div>

<script>
    // --- Data Kuis (100 Soal) ---
    const quizData = [
        { q: "Hitung total nilai di A1 sampai A10", a: "=SUM(A1:A10)", pieces: ["=SUM", "(", "A1:A10", ")"] },
        { q: "Mencari rata-rata di kolom C dari C2 hingga C20", a: "=AVERAGE(C2:C20)", pieces: ["=AVERAGE", "(", "C2:C20", ")"] },
        { q: "Mencari nilai tertinggi di baris 5, kolom B sampai F", a: "=MAX(B5:F5)", pieces: ["=MAX", "(", "B5:F5", ")"] },
        { q: "Mencari nilai terendah di E1 sampai E50", a: "=MIN(E1:E50)", pieces: ["=MIN", "(", "E1:E50", ")"] },
        { q: "Menghitung jumlah data di G10 sampai G30", a: "=COUNT(G10:G30)", pieces: ["=COUNT", "(", "G10:G30", ")"] },
        { q: "Menghitung jumlah data teks di H1:H5, jika memenuhi 'Lulus'", a: "=COUNTIF(H1:H5,\"Lulus\")", pieces: ["=COUNTIF", "(", "H1:H5", ",", "\"Lulus\"", ")"] },
        { q: "Membuat kondisi: Jika B2 lebih dari 100, tampilkan 'Target', jika tidak 'Kurang'", a: "=IF(B2>100,\"Target\",\"Kurang\")", pieces: ["=IF", "(", "B2>100", ",", "\"Target\"", ",", "\"Kurang\"", ")"] },
        { q: "Mencari data VLOOKUP untuk A2 pada tabel D1:F10 (kolom ke-3, False)", a: "=VLOOKUP(A2,D1:F10,3,FALSE)", pieces: ["=VLOOKUP", "(", "A2", ",", "D1:F10", ",", "3", ",", "FALSE", ")"] },
        { q: "Mencari data HLOOKUP untuk B1 pada tabel A5:J5 (baris ke-2, True)", a: "=HLOOKUP(B1,A5:J5,2,TRUE)", pieces: ["=HLOOKUP", "(", "B1", ",", "A5:J5", ",", "2", ",", "TRUE", ")"] },
        { q: "Menggabungkan teks dari C2 dan D2 dengan spasi di tengah", a: "=CONCAT(C2,\" \",D2)", pieces: ["=CONCAT", "(", "C2", ",", "\" \"", ",", "D2", ")"] },
        
        // Tambahan 90 Soal Lainnya (Variasi formula, range, dan argumen)
        { q: "Hitung total nilai di sel C1, C5, dan C9", a: "=SUM(C1,C5,C9)", pieces: ["=SUM", "(", "C1", ",", "C5", ",", "C9", ")"] },
        { q: "Rata-rata dari B3 sampai B12 dan sel B15", a: "=AVERAGE(B3:B12,B15)", pieces: ["=AVERAGE", "(", "B3:B12", ",", "B15", ")"] },
        { q: "Nilai MAX di A1:A50", a: "=MAX(A1:A50)", pieces: ["=MAX", "(", "A1:A50", ")"] },
        { q: "Nilai MIN di Z1:Z100", a: "=MIN(Z1:Z100)", pieces: ["=MIN", "(", "Z1:Z100", ")"] },
        { q: "Menghitung jumlah sel yang tidak kosong di kolom F", a: "=COUNTA(F:F)", pieces: ["=COUNTA", "(", "F:F", ")"] },
        { q: "Jika D2 kurang dari 50, tampilkan 'E'", a: "=IF(D2<50,\"E\",\"Bukan E\")", pieces: ["=IF", "(", "D2<50", ",", "\"E\"", ",", "\"Bukan E\"", ")"] },
        { q: "Mencari Rank untuk E2 di range E2:E20 (Descending)", a: "=RANK(E2,E2:E20,0)", pieces: ["=RANK", "(", "E2", ",", "E2:E20", ",", "0", ")"] },
        { q: "Mengambil 3 karakter pertama dari A1", a: "=LEFT(A1,3)", pieces: ["=LEFT", "(", "A1", ",", "3", ")"] },
        { q: "Mengambil 5 karakter terakhir dari B5", a: "=RIGHT(B5,5)", pieces: ["=RIGHT", "(", "B5", ",", "5", ")"] },
        { q: "Mengambil 4 karakter dari tengah C7, dimulai dari posisi 2", a: "=MID(C7,2,4)", pieces: ["=MID", "(", "C7", ",", "2", ",", "4", ")"] },
        { q: "Membulatkan angka di D1 ke 0 desimal", a: "=ROUND(D1,0)", pieces: ["=ROUND", "(", "D1", ",", "0", ")"] },
        { q: "Membulatkan angka di E4 ke 2 desimal", a: "=ROUND(E4,2)", pieces: ["=ROUND", "(", "E4", ",", "2", ")"] },
        { q: "Menghitung akar kuadrat dari F10", a: "=SQRT(F10)", pieces: ["=SQRT", "(", "F10", ")"] },
        { q: "Menghitung pangkat 3 dari G3", a: "=POWER(G3,3)", pieces: ["=POWER", "(", "G3", ",", "3", ")"] },
        { q: "Mengkonversi teks di A1 menjadi huruf besar", a: "=UPPER(A1)", pieces: ["=UPPER", "(", "A1", ")"] },
        { q: "Mengkonversi teks di B2 menjadi huruf kecil", a: "=LOWER(B2)", pieces: ["=LOWER", "(", "B2", ")"] },
        { q: "Menghitung panjang teks di C3", a: "=LEN(C3)", pieces: ["=LEN", "(", "C3", ")"] },
        { q: "Mencari hari ini", a: "=TODAY()", pieces: ["=TODAY", "(", ")"] },
        { q: "Mencari tanggal dan waktu saat ini", a: "=NOW()", pieces: ["=NOW", "(", ")"] },
        { q: "Menghitung jumlah sel di range A1:A10 yang > 5", a: "=COUNTIF(A1:A10,\">5\")", pieces: ["=COUNTIF", "(", "A1:A10", ",", "\">5\"", ")"] },
        { q: "Menghitung rata-rata di B1:B10 jika nilai di C1:C10 adalah 'Baik'", a: "=AVERAGEIF(C1:C10,\"Baik\",B1:B10)", pieces: ["=AVERAGEIF", "(", "C1:C10", ",", "\"Baik\"", ",", "B1:B10", ")"] },
        { q: "Menghitung total di D1:D10 jika di E1:E10 adalah 'Ya'", a: "=SUMIF(E1:E10,\"Ya\",D1:D10)", pieces: ["=SUMIF", "(", "E1:E10", ",", "\"Ya\"", ",", "D1:D10", ")"] },
        { q: "Mencari tanggal dari teks di A1 (format YYYY, M, D)", a: "=DATE(2025,12,1)", pieces: ["=DATE", "(", "2025", ",", "12", ",", "1", ")"] },
        { q: "Mencari tahu apakah tahun di B2 adalah tahun kabisat", a: "=ISLEAP(B2)", pieces: ["=ISLEAP", "(", "B2", ")"] },
        { q: "Mencari hari dalam seminggu dari C3", a: "=WEEKDAY(C3)", pieces: ["=WEEKDAY", "(", "C3", ")"] },
        { q: "Mengambil nilai absolut dari D4", a: "=ABS(D4)", pieces: ["=ABS", "(", "D4", ")"] },
        { q: "Memotong desimal di E5", a: "=TRUNC(E5)", pieces: ["=TRUNC", "(", "E5", ")"] },
        { q: "Membuat referensi absolut untuk A1", a: "=$A$1", pieces: ["=", "$A$1"] },
        { q: "Membuat referensi kolom absolut untuk A1", a: "=$A1", pieces: ["=", "$A1"] },
        { q: "Membuat referensi baris absolut untuk A1", a: "=A$1", pieces: ["=", "A$1"] },
        { q: "Menghitung nilai median di F1:F20", a: "=MEDIAN(F1:F20)", pieces: ["=MEDIAN", "(", "F1:F20", ")"] },
        { q: "Menghitung modus di G1:G20", a: "=MODE(G1:G20)", pieces: ["=MODE", "(", "G1:G20", ")"] },
        { q: "Menghitung variance di H1:H10 (untuk populasi)", a: "=VAR.P(H1:H10)", pieces: ["=VAR.P", "(", "H1:H10", ")"] },
        { q: "Menghitung deviasi standar di I1:I10 (untuk sample)", a: "=STDEV.S(I1:I10)", pieces: ["=STDEV.S", "(", "I1:I10", ")"] },
        { q: "Menghitung jumlah karakter unik di J1:J5 (Array Formula)", a: "=SUM(1/COUNTIF(J1:J5,J1:J5))", pieces: ["=SUM", "(", "1/COUNTIF", "(", "J1:J5", ",", "J1:J5", ")", ")"] },
        { q: "Mencari indeks dari nilai 'X' di range B1:B10", a: "=MATCH(\"X\",B1:B10,0)", pieces: ["=MATCH", "(", "\"X\"", ",", "B1:B10", ",", "0", ")"] },
        { q: "Mengambil nilai di kolom 2 dari range D1:F10 pada baris ke-3", a: "=INDEX(D1:F10,3,2)", pieces: ["=INDEX", "(", "D1:F10", ",", "3", ",", "2", ")"] },
        { q: "Mencari nilai tengah dari 3 angka (A1, B1, C1)", a: "=MEDIAN(A1,B1,C1)", pieces: ["=MEDIAN", "(", "A1", ",", "B1", ",", "C1", ")"] },
        { q: "Menghitung total nilai di range A1:A5 dan B1:B5", a: "=SUM(A1:A5,B1:B5)", pieces: ["=SUM", "(", "A1:A5", ",", "B1:B5", ")"] },
        { q: "Jika A1=1 DAN B1=2, tampilkan 'BENAR', jika tidak 'SALAH'", a: "=IF(AND(A1=1,B1=2),\"BENAR\",\"SALAH\")", pieces: ["=IF", "(", "AND", "(", "A1=1", ",", "B1=2", ")", ",", "\"BENAR\"", ",", "\"SALAH\"", ")"] },
        { q: "Jika C1=3 ATAU D1=4, tampilkan 'OK', jika tidak 'NOK'", a: "=IF(OR(C1=3,D1=4),\"OK\",\"NOK\")", pieces: ["=IF", "(", "OR", "(", "C1=3", ",", "D1=4", ")", ",", "\"OK\"", ",", "\"NOK\"", ")"] },
        { q: "Menghitung jumlah sel di A1:A50 yang tidak sama dengan 10", a: "=COUNTIF(A1:A50,\"<>10\")", pieces: ["=COUNTIF", "(", "A1:A50", ",", "\"<>10\"", ")"] },
        { q: "Menghitung jumlah sel di B1:B50 yang lebih besar atau sama dengan 75", a: "=COUNTIF(B1:B50,\">=75\")", pieces: ["=COUNTIF", "(", "B1:B50", ",", "\">=75\"", ")"] },
        { q: "Menghitung jumlah sel yang mengandung teks 'Data' di C1:C10", a: "=COUNTIF(C1:C10,\"*Data*\")", pieces: ["=COUNTIF", "(", "C1:C10", ",", "\"*Data*\"", ")"] },
        { q: "Mencari angka unik di range D1:D15", a: "=UNIQUE(D1:D15)", pieces: ["=UNIQUE", "(", "D1:D15", ")"] },
        { q: "Mengurutkan data di E1:E10 secara Ascending", a: "=SORT(E1:E10,1,1)", pieces: ["=SORT", "(", "E1:E10", ",", "1", ",", "1", ")"] },
        { q: "Menghitung rata-rata jika E1 > 5 dan F1 < 10 (Range G1:G10)", a: "=AVERAGEIFS(G1:G10,E1:E10,\">5\",F1:F10,\"<10\")", pieces: ["=AVERAGEIFS", "(", "G1:G10", ",", "E1:E10", ",", "\">5\"", ",", "F1:F10", ",", "\"<10\"", ")"] },
        { q: "Menghitung total jika A1='Produk A' dan B1='Reguler' (Range C1:C10)", a: "=SUMIFS(C1:C10,A1:A10,\"Produk A\",B1:B10,\"Reguler\")", pieces: ["=SUMIFS", "(", "C1:C10", ",", "A1:A10", ",", "\"Produk A\"", ",", "B1:B10", ",", "\"Reguler\"", ")"] },
        // Lanjutkan hingga 100
        { q: "Mengkonversi bilangan biner '101' ke desimal", a: "=BIN2DEC(101)", pieces: ["=BIN2DEC", "(", "101", ")"] },
        { q: "Mengkonversi bilangan desimal 10 ke biner", a: "=DEC2BIN(10)", pieces: ["=DEC2BIN", "(", "10", ")"] },
        { q: "Menentukan angka acak antara 1 dan 100", a: "=RANDBETWEEN(1,100)", pieces: ["=RANDBETWEEN", "(", "1", ",", "100", ")"] },
        { q: "Mengambil nilai EOMONTH 1 bulan setelah A1", a: "=EOMONTH(A1,1)", pieces: ["=EOMONTH", "(", "A1", ",", "1", ")"] },
        { q: "Mengambil nama bulan dari tanggal di B2", a: "=TEXT(B2,\"mmmm\")", pieces: ["=TEXT", "(", "B2", ",", "\"mmmm\"", ")"] },
        { q: "Menghitung nilai faktorial dari 5", a: "=FACT(5)", pieces: ["=FACT", "(", "5", ")"] },
        { q: "Menghilangkan spasi berlebih dari teks di C3", a: "=TRIM(C3)", pieces: ["=TRIM", "(", "C3", ")"] },
        { q: "Mencari nilai terkecil ke-2 di D1:D20", a: "=SMALL(D1:D20,2)", pieces: ["=SMALL", "(", "D1:D20", ",", "2", ")"] },
        { q: "Mencari nilai terbesar ke-3 di E1:E20", a: "=LARGE(E1:E20,3)", pieces: ["=LARGE", "(", "E1:E20", ",", "3", ")"] },
        { q: "Mencari tahun dari tanggal di F1", a: "=YEAR(F1)", pieces: ["=YEAR", "(", "F1", ")"] },
        { q: "Mencari bulan dari tanggal di G1", a: "=MONTH(G1)", pieces: ["=MONTH", "(", "G1", ")"] },
        { q: "Mencari hari dari tanggal di H1", a: "=DAY(H1)", pieces: ["=DAY", "(", "H1", ")"] },
        { q: "Mengubah 0.5 menjadi format persen", a: "=TEXT(0.5,\"0%\")", pieces: ["=TEXT", "(", "0.5", ",", "\"0%\"", ")"] },
        { q: "Mencari nilai yang paling sering muncul di I1:I50", a: "=MODE.SNGL(I1:I50)", pieces: ["=MODE.SNGL", "(", "I1:I50", ")"] },
        { q: "Menghitung jumlah baris di range A1:A10", a: "=ROWS(A1:A10)", pieces: ["=ROWS", "(", "A1:A10", ")"] },
        { q: "Menghitung jumlah kolom di range A1:E1", a: "=COLUMNS(A1:E1)", pieces: ["=COLUMNS", "(", "A1:E1", ")"] },
        { q: "Mencari nilai VLOOKUP (kolom 4) dengan range absolut $A$1:$F$20", a: "=VLOOKUP(A1,$A$1:$F$20,4,FALSE)", pieces: ["=VLOOKUP", "(", "A1", ",", "$A$1:$F$20", ",", "4", ",", "FALSE", ")"] },
        { q: "Mencari hasil perkalian A1 dan B1", a: "=PRODUCT(A1,B1)", pieces: ["=PRODUCT", "(", "A1", ",", "B1", ")"] },
        { q: "Mencari hasil bagi A1 dengan B1", a: "=A1/B1", pieces: ["=", "A1", "/", "B1"] },
        { q: "Mencari sisa bagi A1 dibagi B1", a: "=MOD(A1,B1)", pieces: ["=MOD", "(", "A1", ",", "B1", ")"] },
        { q: "Membuat referensi range dinamis dari B2 ke C2 dengan fungsi INDIRECT", a: "=SUM(INDIRECT(\"B\"&2&\":C\"&2))", pieces: ["=SUM", "(", "INDIRECT", "(", "\"B\"", "&", "2", "&", "\":C\"", "&", "2", ")", ")"] },
        { q: "Mencari Error 'DIV/0!' di A1 dan menggantinya dengan 0", a: "=IFERROR(A1,0)", pieces: ["=IFERROR", "(", "A1", ",", "0", ")"] },
        { q: "Membuat tanggal 10 hari setelah hari ini", a: "=TODAY()+10", pieces: ["=TODAY", "(", ")", "+", "10"] },
        { q: "Menghitung total nilai di range A1:A10 jika nilai di B1:B10 tidak kosong", a: "=SUMIF(B1:B10,\"<>\",A1:A10)", pieces: ["=SUMIF", "(", "B1:B10", ",", "\"<>\"", ",", "A1:A10", ")"] },
        { q: "Menghitung jumlah sel yang merupakan angka di range C1:C5", a: "=COUNT(C1:C5)", pieces: ["=COUNT", "(", "C1:C5", ")"] },
        { q: "Mengambil nilai ke-20 dari deret 1, 3, 5...", a: "=SEQUENCE(1,1,1,2)", pieces: ["=SEQUENCE", "(", "1", ",", "1", ",", "1", ",", "2", ")"] },
        { q: "Mencari hasil pembulatan ke atas dari A1 ke kelipatan 5", a: "=CEILING.MATH(A1,5)", pieces: ["=CEILING.MATH", "(", "A1", ",", "5", ")"] },
        { q: "Mencari hasil pembulatan ke bawah dari B1 ke kelipatan 10", a: "=FLOOR.MATH(B1,10)", pieces: ["=FLOOR.MATH", "(", "B1", ",", "10", ")"] },
        { q: "Mengambil nilai di A1, jika tidak 'Gagal'", a: "=IF(ISBLANK(A1),\"Gagal\",A1)", pieces: ["=IF", "(", "ISBLANK", "(", "A1", ")", ",", "\"Gagal\"", ",", "A1", ")"] },
        { q: "Mencari nilai terkecil ke-1 di range C1:C10", a: "=SMALL(C1:C10,1)", pieces: ["=SMALL", "(", "C1:C10", ",", "1", ")"] },
        { q: "Mencari nilai terbesar ke-1 di range D1:D10", a: "=LARGE(D1:D10,1)", pieces: ["=LARGE", "(", "D1:D10", ",", "1", ")"] },
        { q: "Menghitung total dari 1 hingga 10", a: "=SUM(SEQUENCE(10))", pieces: ["=SUM", "(", "SEQUENCE", "(", "10", ")", ")"] },
        { q: "Mengambil jam dari waktu di E1", a: "=HOUR(E1)", pieces: ["=HOUR", "(", "E1", ")"] },
        { q: "Mengambil menit dari waktu di F1", a: "=MINUTE(F1)", pieces: ["=MINUTE", "(", "F1", ")"] },
        { q: "Mengambil detik dari waktu di G1", a: "=SECOND(G1)", pieces: ["=SECOND", "(", "G1", ")"] },
        { q: "Mengubah teks '123' menjadi angka", a: "=VALUE(\"123\")", pieces: ["=VALUE", "(", "\"123\"", ")"] },
        { q: "Menguji apakah A1 adalah angka", a: "=ISNUMBER(A1)", pieces: ["=ISNUMBER", "(", "A1", ")"] },
        { q: "Menguji apakah B1 adalah teks", a: "=ISTEXT(B1)", pieces: ["=ISTEXT", "(", "B1", ")"] },
        { q: "Mencari posisi karakter 'A' di teks C1", a: "=FIND(\"A\",C1)", pieces: ["=FIND", "(", "\"A\"", ",", "C1", ")"] },
        { q: "Mengganti teks 'lama' dengan 'baru' di D1", a: "=SUBSTITUTE(D1,\"lama\",\"baru\")", pieces: ["=SUBSTITUTE", "(", "D1", ",", "\"lama\"", ",", "\"baru\"", ")"] },
        { q: "Mengulangi teks 'Halo' sebanyak 3 kali", a: "=REPT(\"Halo\",3)", pieces: ["=REPT", "(", "\"Halo\"", ",", "3", ")"] },
        { q: "Menghitung jumlah sel di range A1:A10 yang berisi tanggal", a: "=COUNT(A1:A10)", pieces: ["=COUNT", "(", "A1:A10", ")"] },
        { q: "Menghitung jumlah sel di B1:B10 yang berisi teks", a: "=COUNTA(B1:B10)-COUNT(B1:B10)", pieces: ["=COUNTA", "(", "B1:B10", ")", "-", "COUNT", "(", "B1:B10", ")"] },
        { q: "Menghitung total di C1:C10 jika D1:D10 adalah 'Lunas' (Tingkat 2)", a: "=SUMIFS(C1:C10,D1:D10,\"Lunas\",E1:E10,\"Lvl 2\")", pieces: ["=SUMIFS", "(", "C1:C10", ",", "D1:D10", ",", "\"Lunas\"", ",", "E1:E10", ",", "\"Lvl 2\"", ")"] },
        { q: "Mencari nilai VLOOKUP dengan exact match (kolom 5)", a: "=VLOOKUP(A1,C1:G10,5,FALSE)", pieces: ["=VLOOKUP", "(", "A1", ",", "C1:G10", ",", "5", ",", "FALSE", ")"] },
        { q: "Mencari nilai HLOOKUP dengan approximate match (baris 3)", a: "=HLOOKUP(B1,D1:J5,3,TRUE)", pieces: ["=HLOOKUP", "(", "B1", ",", "D1:J5", ",", "3", ",", "TRUE", ")"] },
        { q: "Mencari alamat sel dari baris 10, kolom 5", a: "=ADDRESS(10,5)", pieces: ["=ADDRESS", "(", "10", ",", "5", ")"] },
        { q: "Mengambil nilai di A1, jika A1 adalah error ganti dengan 'Cek Data'", a: "=IFERROR(A1,\"Cek Data\")", pieces: ["=IFERROR", "(", "A1", ",", "\"Cek Data\"", ")"] },
        { q: "Menghitung sel kosong di range B1:B20", a: "=COUNTBLANK(B1:B20)", pieces: ["=COUNTBLANK", "(", "B1:B20", ")"] },
        { q: "Membuat tanggal dari 3 komponen (tahun 2024, bulan 5, hari 15)", a: "=DATE(2024,5,15)", pieces: ["=DATE", "(", "2024", ",", "5", ",", "15", ")"] },
        { q: "Mencari jumlah hari kerja antara A1 dan B1 (tanpa hari libur)", a: "=NETWORKDAYS(A1,B1)", pieces: ["=NETWORKDAYS", "(", "A1", ",", "B1", ")"] },
        { q: "Mencari hari kerja setelah A1 sebanyak 5 hari", a: "=WORKDAY(A1,5)", pieces: ["=WORKDAY", "(", "A1", ",", "5", ")"] },
        { q: "Menghitung IRR (Internal Rate of Return) dari nilai investasi di C1:C5", a: "=IRR(C1:C5)", pieces: ["=IRR", "(", "C1:C5", ")"] },
        { q: "Menghitung NPV (Net Present Value) dengan rate 10% dan nilai di D1:D5", a: "=NPV(10%,D1:D5)", pieces: ["=NPV", "(", "10%", ",", "D1:D5", ")"] },
        { q: "Menghitung nilai masa depan (FV) dari investasi", a: "=FV(5%,10,100,0,0)", pieces: ["=FV", "(", "5%", ",", "10", ",", "100", ",", "0", ",", "0", ")"] },
        { q: "Menguji apakah A1 adalah TRUE/FALSE", a: "=ISLOGICAL(A1)", pieces: ["=ISLOGICAL", "(", "A1", ")"] },
        { q: "Menguji apakah B1 adalah teks", a: "=ISTEXT(B1)", pieces: ["=ISTEXT", "(", "B1", ")"] },
        { q: "Menguji apakah C1 adalah error", a: "=ISERR(C1)", pieces: ["=ISERR", "(", "C1", ")"] },
        { q: "Menggabungkan A1, B1, dan C1", a: "=CONCAT(A1,B1,C1)", pieces: ["=CONCAT", "(", "A1", ",", "B1", ",", "C1", ")"] },
        { q: "Mengulang teks di D1 sebanyak 4 kali", a: "=REPT(D1,4)", pieces: ["=REPT", "(", "D1", ",", "4", ")"] },
        { q: "Mengambil karakter dari E1 dimulai dari posisi 3 sebanyak 2", a: "=MID(E1,3,2)", pieces: ["=MID", "(", "E1", ",", "3", ",", "2", ")"] },
        { q: "Mengambil 2 karakter dari kiri F1", a: "=LEFT(F1,2)", pieces: ["=LEFT", "(", "F1", ",", "2", ")"] },
        { q: "Mengambil 3 karakter dari kanan G1", a: "=RIGHT(G1,3)", pieces: ["=RIGHT", "(", "G1", ",", "3", ")"] },
        { q: "Mengubah teks di H1 menjadi huruf kapital", a: "=UPPER(H1)", pieces: ["=UPPER", "(", "H1", ")"] },
        { q: "Mengubah teks di I1 menjadi huruf kecil", a: "=LOWER(I1)", pieces: ["=LOWER", "(", "I1", ")"] },
        { q: "Menghilangkan spasi berlebih di J1", a: "=TRIM(J1)", pieces: ["=TRIM", "(", "J1", ")"] },
        { q: "Mencari nilai korelasi antara A1:A10 dan B1:B10", a: "=CORREL(A1:A10,B1:B10)", pieces: ["=CORREL", "(", "A1:A10", ",", "B1:B10", ")"] },
        { q: "Mencari nilai slope regresi linier B1:B10 terhadap A1:A10", a: "=SLOPE(B1:B10,A1:A10)", pieces: ["=SLOPE", "(", "B1:B10", ",", "A1:A10", ")"] },
        { q: "Menghitung total baris yang unik dari A1:A10", a: "=ROWS(UNIQUE(A1:A10))", pieces: ["=ROWS", "(", "UNIQUE", "(", "A1:A10", ")", ")"] },
        { q: "Menghitung total di B1:B10 jika C1='A' atau D1='B'", a: "=SUM(IF((C1:C10=\"A\")+(D1:D10=\"B\"),B1:B10))", pieces: ["=SUM", "(", "IF", "(", "(", "C1:C10=\"A\"", ")", "+", "(", "D1:D10=\"B\"", ")", ",", "B1:B10", ")", ")"] },
        { q: "Mengambil nilai di A1, jika A1 kosong ganti dengan 'N/A'", a: "=IF(A1=\"\",\"N/A\",A1)", pieces: ["=IF", "(", "A1=\"\"", ",", "\"N/A\"", ",", "A1", ")"] },
        { q: "Mencari nilai di baris 5 pada range B1:D10", a: "=INDEX(B1:D10,5,0)", pieces: ["=INDEX", "(", "B1:D10", ",", "5", ",", "0", ")"] },
        { q: "Mencari nilai di kolom 3 pada range B1:D10", a: "=INDEX(B1:D10,0,3)", pieces: ["=INDEX", "(", "B1:D10", ",", "0", ",", "3", ")"] },
        { q: "Mengganti teks 'lama' di A1 menjadi 'baru', hanya 1 kali", a: "=REPLACE(A1,FIND(\"lama\",A1),4,\"baru\")", pieces: ["=REPLACE", "(", "A1", ",", "FIND", "(", "\"lama\"", ",", "A1", ")", ",", "4", ",", "\"baru\"", ")"] },
        { q: "Menghitung nilai logaritma natural dari E1", a: "=LN(E1)", pieces: ["=LN", "(", "E1", ")"] },
        { q: "Menghitung nilai logaritma basis 10 dari F1", a: "=LOG10(F1)", pieces: ["=LOG10", "(", "F1", ")"] },
        { q: "Menghitung nilai PI", a: "=PI()", pieces: ["=PI", "(", ")"] },
        { q: "Membulatkan 12.345 ke bilangan bulat terdekat", a: "=ROUND(12.345,0)", pieces: ["=ROUND", "(", "12.345", ",", "0", ")"] },
        { q: "Membulatkan ke atas 12.1 ke bilangan bulat terdekat", a: "=ROUNDUP(12.1,0)", pieces: ["=ROUNDUP", "(", "12.1", ",", "0", ")"] },
        { q: "Membulatkan ke bawah 12.9 ke bilangan bulat terdekat", a: "=ROUNDDOWN(12.9,0)", pieces: ["=ROUNDDOWN", "(", "12.9", ",", "0", ")"] },
        { q: "Menghitung jumlah hari kerja antara A1 dan B1, dengan hari libur C1:C5", a: "=NETWORKDAYS.INTL(A1,B1,1,C1:C5)", pieces: ["=NETWORKDAYS.INTL", "(", "A1", ",", "B1", ",", "1", ",", "C1:C5", ")"] },
        { q: "Membuat referensi range B2:$D$4", a: "=SUM(B2:$D$4)", pieces: ["=SUM", "(", "B2:$D$4", ")"] },
        { q: "Mencari jumlah sel yang lebih besar dari rata-rata A1:A10", a: "=COUNTIF(A1:A10,\">\"&AVERAGE(A1:A10))", pieces: ["=COUNTIF", "(", "A1:A10", ",", "\">\"", "&", "AVERAGE", "(", "A1:A10", ")", ")"] },
        { q: "Membuat format angka 12000 menjadi 'Rp 12.000'", a: "=TEXT(12000,\"Rp #,##0\")", pieces: ["=TEXT", "(", "12000", ",", "\"Rp #,##0\"", ")"] },
        { q: "Mengambil nilai di A1, jika A1 adalah error N/A ganti dengan 0", a: "=IFNA(A1,0)", pieces: ["=IFNA", "(", "A1", ",", "0", ")"] },
        { q: "Menghitung rata-rata semua angka di A:A", a: "=AVERAGE(A:A)", pieces: ["=AVERAGE", "(", "A:A", ")"] },
        { q: "Menghitung nilai MODUS dengan kriteria 'Pria'", a: "=MODE.SNGL(IF(C1:C10=\"Pria\",B1:B10))", pieces: ["=MODE.SNGL", "(", "IF", "(", "C1:C10=\"Pria\"", ",", "B1:B10", ")", ")"] },
        { q: "Menghitung hari ke-berapa dalam tahun dari tanggal di A1", a: "=A1-DATE(YEAR(A1),1,0)", pieces: ["=", "A1", "-", "DATE", "(", "YEAR", "(", "A1", ")", ",", "1", ",", "0", ")"] },
        { q: "Mengambil 3 karakter pertama dari B2, dan dijadikan huruf besar", a: "=UPPER(LEFT(B2,3))", pieces: ["=UPPER", "(", "LEFT", "(", "B2", ",", "3", ")", ")"] },
        { q: "Menggabungkan VLOOKUP dan IFERROR", a: "=IFERROR(VLOOKUP(A1,C1:D10,2,FALSE),\"Tidak Ada\")", pieces: ["=IFERROR", "(", "VLOOKUP", "(", "A1", ",", "C1:D10", ",", "2", ",", "FALSE", ")", ",", "\"Tidak Ada\"", ")"] },
        { q: "Menghitung kuartil pertama (25%) di range E1:E20", a: "=QUARTILE(E1:E20,1)", pieces: ["=QUARTILE", "(", "E1:E20", ",", "1", ")"] },
        { q: "Menghitung kuartil ketiga (75%) di range F1:F20", a: "=QUARTILE(F1:F20,3)", pieces: ["=QUARTILE", "(", "F1:F20", ",", "3", ")"] },
        { q: "Mencari hasil perkalian A1, B1, dan C1", a: "=PRODUCT(A1:C1)", pieces: ["=PRODUCT", "(", "A1:C1", ")"] },
        { q: "Menghitung nilai faktorial dari 7", a: "=FACT(7)", pieces: ["=FACT", "(", "7", ")"] },
        { q: "Mencari logaritma basis 2 dari 8", a: "=LOG(8,2)", pieces: ["=LOG", "(", "8", ",", "2", ")"] },
        { q: "Menghitung total dari range yang ditentukan oleh teks di B1", a: "=SUM(INDIRECT(B1))", pieces: ["=SUM", "(", "INDIRECT", "(", "B1", ")", ")"] },
        { q: "Membuat urutan angka dari 1 hingga 5, 1 kolom", a: "=SEQUENCE(5)", pieces: ["=SEQUENCE", "(", "5", ")"] },
        { q: "Menghitung jumlah sel di range A1:A10 yang merupakan error", a: "=COUNTIF(A1:A10,NA())", pieces: ["=COUNTIF", "(", "A1:A10", ",", "NA", "(", ")", ")"] },
        { q: "Menguji apakah A1 adalah sel kosong", a: "=ISBLANK(A1)", pieces: ["=ISBLANK", "(", "A1", ")"] },
        { q: "Menghitung jumlah hari antara B1 dan A1", a: "=B1-A1", pieces: ["=", "B1", "-", "A1"] },
        { q: "Menghitung jumlah bulan antara D1 dan C1", a: "=(YEAR(D1)-YEAR(C1))*12+MONTH(D1)-MONTH(C1)", pieces: ["=", "(", "YEAR", "(", "D1", ")", "-", "YEAR", "(", "C1", ")", ")", "*", "12", "+", "MONTH", "(", "D1", ")", "-", "MONTH", "(", "C1", ")"] },
        { q: "Mengambil nilai di range E1:E10, tetapi diurutkan secara Descending", a: "=SORT(E1:E10,-1)", pieces: ["=SORT", "(", "E1:E10", ",", "-1", ")"] },
        { q: "Menghitung total sel yang TIDAK kosong di F1:F20", a: "=COUNTA(F1:F20)", pieces: ["=COUNTA", "(", "F1:F20", ")"] },
        { q: "Menghitung jumlah sel yang mengandung 'Stok' di G1:G10", a: "=COUNTIF(G1:G10,\"*Stok*\")", pieces: ["=COUNTIF", "(", "G1:G10", ",", "\"*Stok*\"", ")"] },
        { q: "Menghitung rata-rata di H1:H10 jika I1:I10 lebih dari 5", a: "=AVERAGEIF(I1:I10,\">5\",H1:H10)", pieces: ["=AVERAGEIF", "(", "I1:I10", ",", "\">5\"", ",", "H1:H10", ")"] },
        { q: "Menghitung nilai Pangkat 4 dari J1", a: "=J1^4", pieces: ["=", "J1", "^", "4"] },
        { q: "Menghitung total (A1*B1)+(C1*D1)", a: "=(A1*B1)+(C1*D1)", pieces: ["=", "(", "A1", "*", "B1", ")", "+", "(", "C1", "*", "D1", ")"] },
        { q: "Menghitung 15% dari E1", a: "=E1*0.15", pieces: ["=", "E1", "*", "0.15"] },
        { q: "Menghitung PPN 11% dari F1", a: "=F1*1.11", pieces: ["=", "F1", "*", "1.11"] },
        { q: "Menghitung total jika A1='Jakarta' dan B1='Laki-laki' (Range C1:C10)", a: "=SUMIFS(C1:C10,A1:A10,\"Jakarta\",B1:B10,\"Laki-laki\")", pieces: ["=SUMIFS", "(", "C1:C10", ",", "A1:A10", ",", "\"Jakarta\"", ",", "B1:B10", ",", "\"Laki-laki\"", ")"] },
        { q: "Mencari nilai HLOOKUP untuk 'Harga' di B1:F5 (baris 4, False)", a: "=HLOOKUP(\"Harga\",B1:F5,4,FALSE)", pieces: ["=HLOOKUP", "(", "\"Harga\"", ",", "B1:F5", ",", "4", ",", "FALSE", ")"] },
        { q: "Menghitung total (A1+B1) dikalikan C1", a: "=(A1+B1)*C1", pieces: ["=", "(", "A1", "+", "B1", ")", "*", "C1"] },
        { q: "Mencari nilai VLOOKUP di kolom 3, range A1:$D$10, Exact Match", a: "=VLOOKUP(B1,A1:$D$10,3,FALSE)", pieces: ["=VLOOKUP", "(", "B1", ",", "A1:$D$10", ",", "3", ",", "FALSE", ")"] },
        { q: "Mengambil 1 karakter dari kiri B1, dan 1 karakter dari kanan C1, digabung", a: "=CONCAT(LEFT(B1,1),RIGHT(C1,1))", pieces: ["=CONCAT", "(", "LEFT", "(", "B1", ",", "1", ")", ",", "RIGHT", "(", "C1", ",", "1", ")", ")"] },
        { q: "Menghitung jumlah sel yang mengandung angka dan teks di A1:D10", a: "=COUNTA(A1:D10)", pieces: ["=COUNTA", "(", "A1:D10", ")"] },
        { q: "Mencari nilai maksimum dari B1:B10 yang memenuhi kriteria 'Aktif'", a: "=MAX(IF(C1:C10=\"Aktif\",B1:B10))", pieces: ["=MAX", "(", "IF", "(", "C1:C10=\"Aktif\"", ",", "B1:B10", ")", ")"] },
        { q: "Mencari nilai minimum dari D1:D10 yang memenuhi kriteria 'Pasif'", a: "=MIN(IF(E1:E10=\"Pasif\",D1:D10))", pieces: ["=MIN", "(", "IF", "(", "E1:E10=\"Pasif\"", ",", "D1:D10", ")", ")"] },
        { q: "Menghitung hari ke-berapa dalam minggu dari tanggal A1 (Minggu=1)", a: "=WEEKDAY(A1,1)", pieces: ["=WEEKDAY", "(", "A1", ",", "1", ")"] },
        { q: "Menghitung hari ke-berapa dalam minggu dari tanggal A1 (Senin=1)", a: "=WEEKDAY(A1,2)", pieces: ["=WEEKDAY", "(", "A1", ",", "2", ")"] },
        { q: "Mencari hasil pembulatan 10.49 ke bawah ke bilangan bulat", a: "=FLOOR(10.49,1)", pieces: ["=FLOOR", "(", "10.49", ",", "1", ")"] },
        { q: "Mencari hasil pembulatan 10.51 ke atas ke bilangan bulat", a: "=CEILING(10.51,1)", pieces: ["=CEILING", "(", "10.51", ",", "1", ")"] },
        { q: "Mencari nilai rata-rata dari A1, B1, C1", a: "=(A1+B1+C1)/3", pieces: ["=", "(", "A1", "+", "B1", "+", "C1", ")", "/", "3"] },
        { q: "Mencari nilai EOMONTH 3 bulan sebelumnya dari A1", a: "=EOMONTH(A1,-3)", pieces: ["=EOMONTH", "(", "A1", ",", "-3", ")"] },
        { q: "Mengambil nilai di A1, jika A1 adalah #REF!, ganti dengan 0", a: "=IFERROR(A1,0)", pieces: ["=IFERROR", "(", "A1", ",", "0", ")"] },
        { q: "Menghitung total B1:B10 jika C1='X', D1='Y', E1='Z'", a: "=SUMIFS(B1:B10,C1:C10,\"X\",D1:D10,\"Y\",E1:E10,\"Z\")", pieces: ["=SUMIFS", "(", "B1:B10", ",", "C1:C10", ",", "\"X\"", ",", "D1:D10", ",", "\"Y\"", ",", "E1:E10", ",", "\"Z\"", ")"] }
    ].sort(() => Math.random() - 0.5); // Mengacak urutan soal

    let currentQuestionIndex = 0;
    const totalQuestions = quizData.length;

    document.getElementById('totalQuestions').textContent = totalQuestions;

    const questionTextEl = document.getElementById('questionText');
    const questionNumberEl = document.getElementById('questionNumber');
    const piecesContainer = document.getElementById('pieces');
    const dropzone = document.getElementById('answer');
    const nextButton = document.getElementById('nextButton');
    const defaultDropzoneText = '<span class="text-gray-400 text-base italic">Tarik potongan formula ke sini...</span>';

    // --- Fungsi Bantuan Modal ---
    function showModal(title, message) {
        document.getElementById('modalTitle').textContent = title;
        document.getElementById('modalMessage').textContent = message;
        document.getElementById('messageModal').classList.remove('hidden');
        document.getElementById('messageModal').classList.add('scale-100');
    }

    function closeModal() {
        document.getElementById('messageModal').classList.add('hidden');
        document.getElementById('messageModal').classList.remove('scale-100');
    }

    // --- Inisialisasi Kuis ---
    function loadQuestion() {
        if (currentQuestionIndex >= totalQuestions) {
            showModal("Selesai!", "Selamat! Anda telah menyelesaikan semua " + totalQuestions + " soal kuis dengan baik.");
            questionTextEl.textContent = "Kuis Selesai!";
            piecesContainer.innerHTML = '';
            dropzone.innerHTML = defaultDropzoneText;
            nextButton.disabled = true;
            return;
        }

        const currentQ = quizData[currentQuestionIndex];
        
        questionNumberEl.textContent = currentQuestionIndex + 1;
        questionTextEl.textContent = "Susun formula Excel untuk: " + currentQ.q;
        dropzone.innerHTML = defaultDropzoneText;
        piecesContainer.innerHTML = '';
        nextButton.disabled = true;
        
        // Acak dan buat potongan formula
        const shuffledPieces = [...currentQ.pieces].sort(() => Math.random() - 0.5);
        
        shuffledPieces.forEach((text, index) => {
            const piece = document.createElement('div');
            piece.className = 'piece bg-white text-blue-700 font-semibold p-3 rounded-lg shadow-md border-b-4 border-blue-500 hover:bg-blue-50 hover:border-blue-600 transition-all duration-150';
            piece.textContent = text.replace(/\\"/g, '"'); // Handle escaped quotes in data
            piece.draggable = true;
            piece.id = 'piece-' + index;
            
            piece.addEventListener('dragstart', handleDragStart);
            piecesContainer.appendChild(piece);
        });
    }

    // --- Event Listeners Drag & Drop ---
    let draggedPiece = null;

    function handleDragStart(e) {
        draggedPiece = e.target;
        // Hanya mengirim text content
        e.dataTransfer.setData('text/plain', e.target.textContent);
        // Memberikan efek visual saat item di-drag
        setTimeout(() => e.target.classList.add('opacity-50'), 0);
    }
    
    function handleDragEnd(e) {
        e.target.classList.remove('opacity-50');
    }

    function handleDragOver(e) {
        e.preventDefault(); // Mengizinkan drop
        dropzone.classList.add('drag-over');
    }

    function handleDragLeave(e) {
        dropzone.classList.remove('drag-over');
    }

    function handleDrop(e) {
        e.preventDefault();
        dropzone.classList.remove('drag-over');

        if (draggedPiece) {
            // Hapus teks default "Tarik potongan..."
            if (dropzone.querySelector('span')) {
                dropzone.innerHTML = '';
            }
            
            // Buat klon dari potongan yang di-drag
            const droppedPiece = draggedPiece.cloneNode(true);
            droppedPiece.classList.remove('opacity-50');
            droppedPiece.draggable = false; // Non-draggable setelah di drop

            // Tambahkan event listener untuk menghapus saat di klik
            droppedPiece.onclick = function() {
                this.remove();
                // Jika dropzone kosong, kembalikan teks default
                if (dropzone.innerHTML.trim() === '') {
                     dropzone.innerHTML = defaultDropzoneText;
                }
            };
            
            // Hapus event dragend dari klon karena sudah tidak draggable
            droppedPiece.removeEventListener('dragend', handleDragEnd);

            // Tambahkan ke dropzone
            dropzone.appendChild(droppedPiece);

            // Hapus potongan asli dari container
            draggedPiece.remove();
            draggedPiece = null;
        }
    }

    // Attach dropzone listeners
    dropzone.addEventListener('dragover', handleDragOver);
    dropzone.addEventListener('dragleave', handleDragLeave);
    dropzone.addEventListener('drop', handleDrop);
    
    // Attach dragend listener to pieces container (using event delegation for simplicity, though direct is often cleaner)
    piecesContainer.addEventListener('dragend', handleDragEnd);
    
    // --- Fungsi Kontrol Kuis ---
    function checkAnswer() {
        // Ambil semua teks dari potongan di dropzone dan gabungkan
        const droppedPieces = dropzone.querySelectorAll('.piece');
        if (droppedPieces.length === 0) {
            showModal("Perhatian", "Anda belum menyusun formula apa pun.");
            return;
        }
        
        let userFormula = '';
        droppedPieces.forEach(p => {
            userFormula += p.textContent;
        });

        const correctFormula = quizData[currentQuestionIndex].a;
        
        // Hapus semua spasi untuk perbandingan ketat
        const normalizedUser = userFormula.replace(/\s/g, '');
        const normalizedCorrect = correctFormula.replace(/\s/g, '');

        if(normalizedUser === normalizedCorrect) {
            showModal("Benar!", "Formula yang Anda susun benar:\n" + correctFormula);
            nextButton.disabled = false;
        } else {
            showModal("Salah!", "Formula yang Anda susun salah. Coba periksa urutan dan kelengkapan potongannya.");
            nextButton.disabled = true;
        }
    }
    
    function resetQuestion() {
        // Pindahkan semua potongan kembali ke piecesContainer dan hapus dari dropzone
        dropzone.querySelectorAll('.piece').forEach(p => {
            p.draggable = true;
            p.onclick = null; // Hapus event click untuk menghapus
            p.addEventListener('dragstart', handleDragStart);
            piecesContainer.appendChild(p);
        });
        
        dropzone.innerHTML = defaultDropzoneText;
        nextButton.disabled = true;
        // Panggil loadQuestion untuk mengacak ulang posisi potongan asli (opsional)
        loadQuestion(); 
    }

    function nextQuestion() {
        currentQuestionIndex++;
        loadQuestion();
    }

    // --- Mulai Kuis ---
    window.onload = loadQuestion;
</script>

</body>
</html>